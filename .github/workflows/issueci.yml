name: labelaction

on:
  issues:
    types:
      - opened
      - edited

jobs:

  label_issue:
    timeout-minutes: 10
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
        with:
          submodules: true
          fetch-depth: 0

      - uses: oras-project/setup-oras@v1
        with:
          version: 1.0.0

      - name: label issue
        run: |
          cd scripts
          echo ${{ toJSON(github.event) }} > event.json
          cat event.json
          rm -f issueci.sh
          oras pull -uliangyuanpeng -p${{ secrets.GITHUB_TOKEN }} ghcr.io/liangyuanpeng/lanfiles:issueci.sh

#          ./issueci.sh ${{ github.event.issue.number }} "${{ github.event.issue.user.login }}" "${{github.event.issue.title }}" "${{github.event.issue.body }}" "${{ github.event.action}}"


  #     - name: labelissue
  #       uses: actions/github-script@v3
  #       with:
  #         script: |
  #           const creator = context.issue.user.login;
  #           if (creator === 'liangyuanpeng') {
  #             github.issues.addLabels({
  #               issue_number: context.issue.number,
  #               labels: ['utterances',"comments"]
  #             });
  #           }

  # check_issue:
  #   timeout-minutes: 10
  #   runs-on: ubuntu-latest
  #   steps:
  #     - name: Check issue title
  #       uses: actions/github-script@v3
  #       with:
  #         script: |
  #           const title = context.issue.title;
  #           const creator = context.issue.user.login;
  #           if (!title.endsWith('-远鹏的博客 | liangyuanpeng's Blog')) {
  #             if (creator !== 'utterances-bot' && creator !== 'liangyuanpeng') {
  #               github.issues.update({
  #                 issue_number: context.issue.number,
  #                 title: '不合规的issue标题'
  #               });
  #             }
  #           }
