---
layout:     post 
slug:      "service-lank8s.cn"
title:      "lank8s.cnæœåŠ¡"
subtitle:   ""
description: "å›½å†…registry.k8s.ioåŸºæœ¬é•œåƒç«™,kubernetes!"
date:       2021-11-15
author:     "æ¢è¿œé¹"
image: "https://res.cloudinary.com/lyp/image/upload/v1635353670/hugo/banner/pexels-helena-lopes-2253275.jpg"
published: true
wip: true
weight: 1
tags:
    - lank8scn 
    - tech
    - kubernetes
    - knative
    - tekton
    - kind
    - distroless
categories: [ kubernetes ]
---


Hi there ğŸ‘‹  

> å›½å†…å®‰è£…K8SåŸºæœ¬é•œåƒç«™---> lank8s.cn


æ¬¢è¿ä½¿ç”¨ï¼Œæœ‰é—®é¢˜/å»ºè®®éƒ½å¯ä»¥åŠ æˆ‘å¾®ä¿¡äº¤æµï¼Œåœ¨åšå®¢åº•éƒ¨å¯ä»¥æ‰¾åˆ°æˆ‘çš„å¾®ä¿¡è”ç³»æ–¹å¼ :)

`lank8s.cn`çš„ä½¿å‘½æ˜¯å¸Œæœ›å›½å†…èƒ½å¤Ÿæ›´ä½é—¨æ§›çš„å­¦ä¹  Kubernetes æŠ€æœ¯!

åœ¨å¾®è½¯çš„é•œåƒä»£ç†èŠ‚ç‚¹è¿˜å¯ç”¨çš„æ—¶å€™,`azk8s.cn`ä¸€ç›´æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©,ä½†æ˜¯2020å¹´ä¸ŠåŠå¹´å¾®è½¯ä¸å†å¯¹å¤–æä¾›azk8sæœåŠ¡,åªå¯¹å¾®è½¯äº‘çš„å›½å†…æœåŠ¡å™¨æä¾›æœåŠ¡,éå¸¸çš„é—æ†¾ã€‚

åœ¨è¿™æ ·ä¸€ä¸ªèƒŒæ™¯ä¸‹æˆ‘åˆ›ç«‹äº† `lank8s.cn`,ç›®å‰åªæä¾›æ­å»ºK8Sæ‰€éœ€è¦çš„æœ€åŸºæœ¬çš„é•œåƒ,å¸Œæœ›å›½å†…æŠ€æœ¯äººåœ¨å­¦ä¹ K8Sä¹‹åˆèƒ½å¤Ÿå¾ˆå¥½çš„è¿›è¡Œä¸€ä¸ª Kubernetes çš„ Hello World!

ä½¿ç”¨çš„æ–¹å¼ä¹Ÿéå¸¸ç®€å•,å¦‚æœä½¿ç”¨äº† kubeadm æ¥è¿›è¡Œæ­å»ºK8Sé›†ç¾¤,åªéœ€è¦ä¸€è¡Œå‘½ä»¤å°±å¯ä»¥å¿«é€Ÿå¼€å§‹ï¼š

```shell
kubeadm init --image-repository=lank8s.cn --kubernetes-version=v1.17.4 --pod-network-cidr=10.244.0.0/16 --service-cidr=10.96.0.0/12 --ignore-preflight-errors=Swap 
```  

å…¶ä¸­ä½¿ç”¨ image-repository å‚æ•°æŒ‡å®šé•œåƒçš„ä»“åº“ä¸º`lank8s.cn`å³å¯.

ä¸Šè¿°ä¾‹å­æ˜¯éƒ¨ç½²ä¸€ä¸ª 1.17.4 ç‰ˆæœ¬çš„ K8S ,å¦‚éœ€å…¶ä»–ç‰ˆæœ¬å¯è‡ªè¡Œä¿®æ”¹.   

# lank8s.cnå’Œregistry.aliyuncs.com/google_containersçš„åŒºåˆ«  

registry.aliyuncs.com/google_containers æ˜¯å®šæ—¶åŒæ­¥kubernetesçš„é•œåƒåˆ°é˜¿é‡Œé•œåƒä»“åº“æœåŠ¡çš„,ä½†åªæ˜¯K8Sç»„ä»¶çš„é•œåƒ,å¯ä»¥çœ‹ä¸‹å’Œ lank8s.cn çš„å¯¹æ¯”:  


 | k8sç»„ä»¶é•œåƒ    |  k8s.gcr.ioå…¶ä»–é•œåƒ  |  åŠæ—¶æ€§  |  å®¹æ˜“è®° 
--------   | :--------:   | :----: |  :--------: |  :--------:
registry.aliyuncs.com/google_containers       | æ”¯æŒ      |   ä¸æ”¯æŒ    | å®šæ—¶,å­˜åœ¨æ—¶é—´å·®    |  å®¹æ˜“è®° 
lank8s.cn        | æ”¯æŒ      |   æ”¯æŒ    |  ç›´æ¥ä» registry.k8s.io æ‹‰å–,ä¸å­˜åœ¨æ—¶é—´å·®    |   å®¹æ˜“è®°,çŸ­åŸŸå
   
# æŠ€æœ¯ä½¿äººæ‡’æƒ°   

æˆ‘ä»¬çŸ¥é“,ä¸ç®¡ä½¿ç”¨å“ªä¸€ç§æ–¹å¼,æˆ‘ä»¬éƒ½å°‘ä¸äº†çš„æ­¥éª¤æ—¶å†éƒ¨ç½²ä¸€äº› `registry.k8s.io` çš„èµ„æºæ—¶éœ€è¦åœ¨éƒ¨ç½²å‰å°† `registry.k8s.io` çš„é•œåƒä¿®æ”¹ä¸ºå›½å†…æŸä¸ªåœ°æ–¹(ä¾‹å¦‚ `lank8s.cn`),è¿™æ ·çš„äº‹æƒ…åšå¾—å¤šäº†ä¹Ÿä¼šæ˜¾å¾—ç¹ç.  

~~å› æ­¤æˆ‘ä»¬å³å°†æ¨å‡ºä¸€ä¸ªk8s mutating webhook, è¿™ä¸ªwebhookçš„å”¯ä¸€ä½œç”¨å°±æ˜¯åœ¨åˆ›å»ºæˆ–æ›´æ–°èµ„æº(ä¾‹å¦‚Deployment,Statefulset)å°†`k8s.gcr.io`ä¿®æ”¹ä¸º`lank8s.cn`.åç»­ä¹Ÿä¼šæ”¯æŒå‚æ•°åŒ–,ä¾‹å¦‚æ”¯æŒé…ç½®å°†`registry.aliyuncs.com/google_containers`ä¿®æ”¹ä¸º`lank8s.cn`~~  

ä½ å¯ä»¥ä¸º containerd é…ç½®ä»“åº“é•œåƒ,è¿™æ ·å½“ä½ æ‹‰å– registry.k8s.io çš„é•œåƒæ—¶ï¼Œä¸å†éœ€è¦å»æ‰‹åŠ¨ä¸ºæ¯ä¸ªé•œåƒä¿®æ”¹åœ°å€,å¯ä»¥ç›´æ¥ä½¿ç”¨åˆ° lank8scn æœåŠ¡. å‚è€ƒ[æ–‡ç« :ä¸ºcontainerdé…ç½®ä»“åº“é•œåƒ](https://liangyuanpeng.com/post/cncf-containerd/registry-mirrors-for-containerd/)

# æœåŠ¡è¯´æ˜  

## ä»“åº“é•œåƒå¯¹åº”

åŸå§‹ä»“åº“    |  lank8sæœåŠ¡ 
 --------   | :--------:   
  registry.k8s.io      |   registry.lank8s.cn   
  registry.k8s.io      |   lank8s.cn  
 gcr.io     |   gcr.lank8s.cn   


## ä½¿ç”¨

ç”±äºç»´æŠ¤ `lank8s.cn` å­˜åœ¨ä¸€å®šçš„ç»æµå‹åŠ›(æœåŠ¡å™¨è´¹ç”¨,åŸŸåè´¹ç”¨,å¸¦å®½è´¹ç”¨ç­‰),å› æ­¤ `lank8s.cn` ä¿è¯å¯ç”¨æ€§,ä½†ä¸ä¿è¯ç»ä½³çš„é•œåƒä¸‹è½½é€Ÿåº¦.   

è¿™æ ·çš„åŸå› æ˜¯è¶Šæ¥è¶Šå¤šäººä½¿ç”¨ `lank8s.cn`,é•œåƒä¸‹è½½é€Ÿåº¦ä¼šå˜æ…¢,è€Œæå‡æœåŠ¡å™¨é…ç½®/å¸¦å®½æ˜¯è§£å†³è¿™ç±»é—®é¢˜çš„æ–¹æ³•.å¦‚æœæœ‰å¯¹ `lank8s.cn` çš„èµåŠ©å°†æŠŠæ‰€æœ‰èµåŠ©éƒ½ä½¿ç”¨åœ¨ `lank8s.cn` æœåŠ¡çš„ä¼˜åŒ–ä¸Š.

# å®‰å…¨æ€§

ç”±äº lank8s.cn æ˜¯ä¸€ä¸ªé•œåƒæœåŠ¡,é‚£ä¹ˆå¿…ç„¶ä¼šå­˜åœ¨ä¸€ä¸ªå®‰å…¨æ€§çš„é—®é¢˜,å¦‚ä½•ä¿è¯æ‹‰å–åˆ°çš„å®¹å™¨é•œåƒä¸ä¸Šæ¸¸(gcr.io ç­‰åœ°å€)çš„å®¹å™¨é•œåƒæ˜¯ç›¸åŒçš„å‘¢? 

å¯ä»¥çœ‹çœ‹å®˜æ–¹æ–‡ç« :[éªŒè¯å·²ç­¾åå®¹å™¨é•œåƒ](https://kubernetes.io/zh-cn/docs/tasks/administer-cluster/verify-signed-artifacts/)  

ä»æ–‡ç« ä¸­äº†è§£åˆ°,kubernetes 1.24ä»¥åŠä¹‹åç‰ˆæœ¬çš„å†…å®¹éƒ½å¯ä»¥ä½¿ç”¨ cosign æ¥æ ¡éªŒ kubernetes ç»„ä»¶çš„æ•°æ®å®Œæ•´æ€§.

è¿™é‡Œç»™å‡ºä¸€ä¸ªç®€å•çš„æ ¡éªŒå®¹å™¨é•œåƒçš„ç¤ºä¾‹:

```shell
COSIGN_EXPERIMENTAL=1 cosign verify registry.lank8s.cn/kube-apiserver-amd64:v1.24.0
```

æ ¡éªŒ kube-apiserver 1.24 ç‰ˆæœ¬çš„é•œåƒ.

æ³¨æ„:ä½ ä»å“ªé‡Œä¸‹è½½çš„é•œåƒå°±ä»å“ªé‡Œæ ¡éªŒé•œåƒ,ä¾‹å¦‚å¦‚æœä½ çš„é•œåƒåœ°å€æ˜¯ `abc.com/kube-apiserver-amd64:v1.24.0`,é‚£ä¹ˆä½ çš„æ ¡éªŒå‘½ä»¤åº”è¯¥æ˜¯:

```shell
COSIGN_EXPERIMENTAL=1 cosign verify abc.com/kube-apiserver-amd64:v1.24.0
```

# k8s.lank8s.cn å°†è¢«æ·˜æ±°

å®˜æ–¹é•œåƒ `k8s.gcr.io` ä½¿ç”¨ `registry.k8s.io` æ›¿ä»£,è€Œ lank8s æœåŠ¡ä¹Ÿä¼šè·Ÿéšä¸Šæ¸¸,å°† `k8s.lank8s.cn` æ·˜æ±°,è¯·ä½¿ç”¨ `registry.k8s.io` çš„é•œåƒæœåŠ¡ `registry.lank8s.cn`.

# åº”ç”¨åœºæ™¯

é™¤äº†æ‹‰å– K8S å®˜æ–¹ç»„ä»¶é•œåƒä¹‹å¤–,å…¸å‹çš„åº”ç”¨åœºæ™¯æœ‰ä»¥ä¸‹å‡ ä¸ª:  

- tekton é•œåƒ,ä½¿ç”¨ gcr.lank8s.cn/tekton-releases æ¥æ‹‰å– gcr.io/tekton-releases ä¸‹çš„é•œåƒ
- knative é•œåƒ, ä½¿ç”¨ gcr.lank8s.cn/knative-releases æ¥æ‹‰å– gcr.io/knative-releases ä¸‹çš„é•œåƒ
- ml-pipeline é•œåƒ,ä½¿ç”¨ gcr.lank8s.cn/ml-pipeline æ¥æ‹‰å– gcr.io/ml-pipeline ä¸‹çš„é•œåƒ
- kubernetes çš„ CI é•œåƒ,ä½¿ç”¨gcr.lank8s.cn/k8s-staging-ci-images æ¥æ‹‰å– gcr.io/k8s-staging-ci-images ä¸‹çš„é•œåƒ
- ä½¿ç”¨ gcr.lank8s.cn/google_samples æ¥æ‹‰å– gcr.io/google_samples ä¸‹çš„é•œåƒ
- ä½¿ç”¨ gcr.lank8s.cn/distroless æ¥æ‹‰å– gcr.io/distroless ä¸‹çš„é•œåƒ
- ä½¿ç”¨ gcr.lank8s.cn/etcd-development æ¥æ‹‰å– gcr.io/etcd-development ä¸‹çš„é•œåƒ
- ä½¿ç”¨ gcr.lank8s.cn/k8s-staging-sig-auth æ¥æ‹‰å– gcr.io/k8s-staging-sig-auth ä¸‹çš„é•œåƒ  

# å¯èƒ½çš„ä»˜è´¹æœåŠ¡  

ä¸ºä»€ä¹ˆæ˜¯å¯èƒ½å‘¢?  

å› ä¸ºåœ¨æœåŠ¡å™¨å‹åŠ›æ‰¿å—èŒƒå›´å†…çš„è¯`gcr.lank8s.cn`ã€`lank8s.cn`ã€`registry.lank8s.cn`ã€`k8s.lank8s.cn` éƒ½ä¼šå…è´¹æä¾›æœåŠ¡,ä½†ä½¿ç”¨çš„äººè¶Šæ¥è¶Šå¤šä¹‹åæœåŠ¡å™¨æ‰¿å—ä¸äº†å¤ªå¤šäººå…±åŒä½¿ç”¨æ—¶`gcr.lank8s.cn`(`lank8s.cn`/`registry.lank8s.cn`ä¾ç„¶æ˜¯å…è´¹æœåŠ¡)å°†ä¼šä½œä¸ºä»˜è´¹æœåŠ¡æ¨å‡º.ç»è¿‡å¤šæ¬¡å†³ç­–,æœ€ç»ˆå®šä»·ä¸º15ä¸€å¹´.æœ‰æ„è€…è¯·åŠ æˆ‘å¾®ä¿¡,è°¢è°¢!  

ç”±äºæœ¬æ„ä¸æ˜¯ä¸ºäº†èµšé’±,å› æ­¤å³ä½¿æ˜¯æ”¶è´¹ä¹Ÿä¼šé‡‡å–æ¯”è¾ƒå®½å®¹çš„ç­–ç•¥,æ¯”å¦‚ä»˜è´¹ç”¨æˆ·åœ¨ç™»å½•äº† `lank8s.cn` (æ‹‰å–é•œåƒæ—¶å¸¦æœ‰æ­£ç¡®çš„è®¤è¯ä¿¡æ¯)åå…¶æ‰€åœ¨ IP éƒ½å¯ä»¥å…è´¹(æ— éœ€ç™»å½•)æ‹‰å–é•œåƒ.

ä¹Ÿå°±æ˜¯ä¸€ä¸ªå±€åŸŸç½‘å†…,åªè¦æœ‰ä¸€ä¸ªèŠ‚ç‚¹ç™»å½•äº† `lank8s.cn`,é‚£ä¹ˆå…¶ä»–èŠ‚ç‚¹éƒ½å¯ä»¥ç›´æ¥ä½¿ç”¨æœåŠ¡.

åœ¨æœåŠ¡å…è´¹æœŸé—´æˆä¸ºäº†ä»˜è´¹ç”¨æˆ·çš„äººå‘˜å°†ä¼šé¢å¤–èµ é€ä¸€å¹´ä½¿ç”¨æ—¶é—´.

![weixin](https://res.cloudinary.com/lyp/image/upload/v1614786289/weixin.jpg)

# é¢å¤–ä»˜è´¹æœåŠ¡

ä¸º us-central1-docker.pkg.dev æä¾›é•œåƒæœåŠ¡,8å…ƒ3ä¸ªæœˆ. åŠ æˆ‘å¾®ä¿¡ä¸æˆ‘è”ç³»:)

æ˜ å°„å…³ç³»:  

us-central1-docker.pkg.dev ---> us-central1-docker.pkgdev.lank8s.cn

é•œåƒæ¡ˆä¾‹:

- https://docs.robusta.dev  kubernetesçš„å¯è§‚æµ‹æ€§ç›‘æ§æ–¹æ¡ˆ


# æ¥å—èµåŠ©

ä¸ºäº†æä¾›æ›´å¥½çš„æœåŠ¡,æˆ‘åœ¨ä¸‹é¢è´´å‡ºä¸¤ä¸ªäºŒç»´ç æ¥å—èµåŠ©,æˆ‘æ‰¿è¯ºæ‰€æœ‰èµåŠ©éƒ½åªä¼šç”¨äºä¼˜åŒ–`lank8s.cn`æœåŠ¡.  

![zhifubao](https://res.cloudinary.com/lyp/image/upload/v1616142335/pay/zhifubao.png)  

![weixin](https://res.cloudinary.com/lyp/image/upload/v1616142330/pay/weixin.png)
