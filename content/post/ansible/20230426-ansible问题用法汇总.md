---
layout:     post 
title:      "ansible问题用法汇总"
slug:      "ansible-qa"
subtitle:   ""
description: "ansible问题用法汇总"
#do not show it on the top
date:       2021-04-26
#date:       2023-04-26
author:     "梁远鹏"
image: "/img/banner/stargazing_1.jpeg"
published: true
tags:
    - ansible
categories: 
    - TECH
---

# 前言 

本文长期更新,欢迎投稿:)


# 入门用法

这个只是记录一下最简单的一个用法示例

```yaml
---
- hosts: deploy
  vars:

  tasks:

    - name: create fold
      shell: mkdir -p /root/dev/lank8s

    - name: copy yaml
      copy:
        src: /home/lan/repo/git/lank8s/deploy/test/files/
        dest: /root/dev/lank8s/

    - name: docker-compose up
      shell: cd /root/dev/lank8s && docker-compose -f docker-compose-parser.yml up -d && docker-compose -f docker-compose-ecf.yml up -d

    - name: docker-compose ps
      shell: cd /root/dev/lank8s && docker-compose -f docker-compose-parser.yml ps
```

```shell
ansible-playbook -i ansible/hostfile ansible/book.yml
```

上述配置以及命令表示 调用 ansible-playbook 去对一组机器执行一批命令,一组机器的组名为 deploy,一批命令则是各个 tasks.

命令的效果是在远程机器上做如下操作:

1. 创建目录 `/root/dev/lank8s`
2. 复制本机器 `/home/lan/repo/git/lank8s/deploy/test/files/` 下的文件到远程机器的 `/root/dev/lank8s/`
3. 在远程机器执行命令 `cd /root/dev/lank8s && docker-compose -f docker-compose-parser.yml up -d && docker-compose -f docker-compose-ecf.yml up -d`
4. 在远程机器执行命令 ` cd /root/dev/lank8s && docker-compose -f docker-compose-parser.yml ps`


# 常用/关键

## 直接在当前机器执行命令

ansible -i localhost
ansible-playbook -i localhost book.yml